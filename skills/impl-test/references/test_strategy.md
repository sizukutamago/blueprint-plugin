---
doc_type: test_strategy
version: "{{VERSION}}"
status: "{{STATUS}}"
updated_at: "{{UPDATED_AT}}"
owners:
  - "{{OWNER_EMAIL}}"
tags:
  - "テスト"
  - "テスト戦略"
  - "品質保証"
coverage:
  fr: []
  nfr: []
---

# テスト戦略書

---

## 目次

1. [テスト方針](#テスト方針)
2. [テストレベル定義](#テストレベル定義)
3. [テスト責任マトリクス](#テスト責任マトリクス)
4. [リスクベース優先順位付け](#リスクベース優先順位付け)
5. [テストデータ戦略](#テストデータ戦略)
6. [テスト自動化戦略](#テスト自動化戦略)
7. [テスト完了基準](#テスト完了基準)
8. [関連ドキュメント](#関連ドキュメント)
9. [変更履歴](#変更履歴)

---

## テスト方針

### 目的

{{PROJECT_NAME}} における品質保証活動の方針を定義し、テストプロセス全体の指針を示す。

### 原則

| 原則 | 説明 |
|------|------|
| 早期テスト | 開発工程の早期段階からテストを実施し、不具合の早期発見を図る |
| リスクベース | ビジネスリスクに基づきテスト優先順位を決定する |
| 自動化優先 | 回帰テストを中心に自動化を推進し、手動テストは探索的テストに集中する |
| シフトレフト | 静的解析・型検査・リンターを活用し、実行前に不具合を検出する |

### 品質目標

| 指標 | 目標値 | 測定方法 |
|------|--------|----------|
| ステートメントカバレッジ | {{STATEMENT_COVERAGE_TARGET}} | {{COVERAGE_TOOL}} |
| ブランチカバレッジ | {{BRANCH_COVERAGE_TARGET}} | {{COVERAGE_TOOL}} |
| 重大バグ残存数（リリース時） | {{CRITICAL_BUG_TARGET}} | 不具合管理ツール |
| バグ密度（KLOC あたり） | {{BUG_DENSITY_TARGET}} | 不具合数 / コード行数 |

---

## テストレベル定義

### 単体テスト

| 項目 | 内容 |
|------|------|
| 目的 | 個々の関数・コンポーネントのロジック検証 |
| スコープ | ビジネスロジック、ユーティリティ関数、カスタムフック、UI コンポーネント |
| ツール | {{UNIT_TEST_TOOL}} |
| 担当 | 開発者 |
| 開始基準 | コーディング完了、型エラーゼロ |
| 終了基準 | カバレッジ目標達成、全テスト PASS |

#### 単体テスト方針

- モック/スタブを使用して外部依存を排除する
- 境界値分析・同値分割を適用する
- 各関数の正常系・異常系を網羅する

### 結合テスト

| 項目 | 内容 |
|------|------|
| 目的 | モジュール間・API/DB 間の契約検証 |
| スコープ | API エンドポイント、データベース操作、外部サービス連携 |
| ツール | {{INTEGRATION_TEST_TOOL}} |
| 担当 | 開発者 |
| 開始基準 | 単体テスト完了、API 実装完了 |
| 終了基準 | 主要パスの結合テスト PASS、エラーハンドリング検証完了 |

#### 結合テスト方針

- テスト用データベースを使用する（本番データ使用禁止）
- 外部サービスはモックサーバーを使用する
- トランザクションの整合性を検証する

### E2E テスト

| 項目 | 内容 |
|------|------|
| 目的 | ユーザーフロー全体の動作検証 |
| スコープ | 主要ユーザーシナリオ、クロスブラウザ検証 |
| ツール | {{E2E_TEST_TOOL}} |
| 担当 | QA / 開発者 |
| 開始基準 | 結合テスト完了、ステージング環境構築完了 |
| 終了基準 | 主要シナリオ PASS、クリティカルパスの異常系検証完了 |

#### E2E テスト方針

- Page Object Model パターンを採用する
- テストデータのセットアップ・クリーンアップを自動化する
- 不安定なテスト（Flaky Test）は即時修正または隔離する

### 受入テスト

| 項目 | 内容 |
|------|------|
| 目的 | ビジネス要件（Gherkin シナリオ）の充足検証 |
| スコープ | 全 FR に対応する受入基準（SC） |
| ツール | {{ACCEPTANCE_TEST_TOOL}} |
| 担当 | PO / QA |
| 開始基準 | E2E テスト完了、全機能実装完了 |
| 終了基準 | 全 SC の検証完了、PO 承認 |

#### 受入テスト方針

- user-stories.md の Gherkin シナリオに基づいて検証する
- ビジネス視点で「ユーザーが期待する動作」を確認する
- 不合格項目は FR-ID を付けて不具合報告する

---

## テスト責任マトリクス

RACI形式で各テスト活動の責任分担を定義する。

| テスト活動 | 開発者 | QA | PO | DevOps |
|-----------|--------|-----|-----|--------|
| 単体テスト作成・実行 | R/A | I | - | - |
| 結合テスト作成・実行 | R/A | C | - | I |
| E2E テスト作成 | C | R/A | C | I |
| E2E テスト実行 | I | R/A | I | C |
| 受入テスト計画 | C | R | A | - |
| 受入テスト実行 | I | R | A | - |
| パフォーマンステスト | C | R/A | I | C |
| セキュリティテスト | C | R/A | I | C |
| テスト環境構築 | C | I | - | R/A |
| CI/CD パイプライン | C | I | - | R/A |
| 不具合トリアージ | C | R | A | - |
| リリース判定 | I | R | A | C |

> R: 実行責任, A: 説明責任, C: 相談先, I: 情報共有先

---

## リスクベース優先順位付け

### リスク評価基準

リスクレベルは「影響度 x 発生確率」で決定する。

#### 影響度

| レベル | 定義 | スコア |
|--------|------|--------|
| 高 | データ損失・セキュリティ侵害・金銭的損害 | 3 |
| 中 | 機能停止・ワークフロー中断 | 2 |
| 低 | 表示崩れ・軽微な不便 | 1 |

#### 発生確率

| レベル | 定義 | スコア |
|--------|------|--------|
| 高 | 日常的に発生しうる操作パス | 3 |
| 中 | 特定条件下で発生する操作パス | 2 |
| 低 | 稀にしか発生しない操作パス | 1 |

#### リスクマトリクス

| | 発生確率: 高(3) | 発生確率: 中(2) | 発生確率: 低(1) |
|------|---------------|---------------|--------------|
| 影響度: 高(3) | 9: Critical | 6: High | 3: Medium |
| 影響度: 中(2) | 6: High | 4: Medium | 2: Low |
| 影響度: 低(1) | 3: Medium | 2: Low | 1: Low |

### カテゴリ別ルール

| カテゴリ | リスクレベル | テスト深度 |
|---------|------------|-----------|
| 認証・認可 | Critical | 全パス + 境界値 + 異常系 + ペネトレーション |
| 決済・課金 | Critical | 全パス + 境界値 + 異常系 + 二重実行防止 |
| データ整合性 | High | 全パス + 境界値 + 異常系 + 並行処理 |
| CRUD 操作 | Medium | 主要パス + 代表的異常系 |
| 検索・フィルター | Medium | 主要パス + 境界値（0件・大量データ） |
| 一覧表示 | Medium | 主要パス + ページネーション境界 |
| 静的表示 | Low | 正常系のみ |
| 設定・プロファイル | Low | 正常系 + バリデーション |

### 機能別リスク評価

| FR-ID | 機能名 | 影響度 | 発生確率 | リスクスコア | テスト深度 |
|-------|--------|--------|----------|------------|-----------|
| {{FR_ID}} | {{FR_NAME}} | {{IMPACT}} | {{PROBABILITY}} | {{RISK_SCORE}} | {{TEST_DEPTH}} |

---

## テストデータ戦略

### データ分類

| 分類 | 説明 | 例 |
|------|------|-----|
| マスターデータ | テスト前提として事前投入するデータ | ユーザー、カテゴリ、設定値 |
| トランザクションデータ | テスト実行中に生成されるデータ | 注文、投稿、ログ |
| 境界値データ | 境界条件の検証用に特別に用意するデータ | 空文字、最大長、ゼロ、負数 |

### テストデータ生成方法

| 方法 | 用途 | ツール |
|------|------|--------|
| ファクトリー関数 | 単体・結合テスト | {{FACTORY_TOOL}} |
| シードスクリプト | E2E テスト | {{SEED_TOOL}} |
| フィクスチャファイル | 固定データ | JSON/YAML ファイル |

### PII マスキング方針

| データ種別 | マスキング方法 |
|-----------|--------------|
| メールアドレス | `test+{{ID}}@example.com` 形式で生成 |
| 氏名 | ダミー名（「テスト太郎」等）を使用 |
| 電話番号 | `090-0000-XXXX` 形式で生成 |
| 住所 | 架空住所（「東京都テスト区1-1-1」等）を使用 |
| 決済情報 | テスト用トークン・ダミーカード番号を使用 |

> **重要**: 本番データをテスト環境に使用する場合は、必ずマスキング処理を実施すること。

---

## テスト自動化戦略

### 自動化対象

| 対象 | 理由 |
|------|------|
| 回帰テスト | 繰り返し実行が必要、手動では工数が膨大 |
| スモークテスト | デプロイ後の迅速な検証が必要 |
| データ駆動テスト | 大量のパラメータ組み合わせを検証 |
| API 契約テスト | リクエスト/レスポンスの型整合性を自動検証 |

### 自動化対象外

| 対象 | 理由 |
|------|------|
| 探索的テスト | 人間の直感・経験が必要 |
| ユーザビリティテスト | 主観的評価が必要 |
| 初回の UI 検証 | ビジュアル確認は人間が判断 |

### CI/CD 統合方針

| パイプラインステージ | 実行テスト | 失敗時の動作 |
|-------------------|-----------|------------|
| pre-commit | リンター、型チェック | コミット拒否 |
| push | 単体テスト | マージ拒否 |
| PR | 単体 + 結合テスト | マージ拒否 |
| staging deploy | E2E スモークテスト | デプロイロールバック |
| release | 全自動テスト | リリース停止 |

### 自動化率目標

| テストレベル | 自動化率目標 | 備考 |
|------------|------------|------|
| 単体テスト | {{UNIT_AUTOMATION_TARGET}} | 原則 100% 自動化 |
| 結合テスト | {{INTEGRATION_AUTOMATION_TARGET}} | API テストは全自動化 |
| E2E テスト | {{E2E_AUTOMATION_TARGET}} | 主要シナリオを自動化 |
| 受入テスト | {{ACCEPTANCE_AUTOMATION_TARGET}} | Gherkin 自動実行可能分 |

---

## テスト完了基準

### 定量基準

| 基準 | 目標値 | 測定方法 |
|------|--------|----------|
| ステートメントカバレッジ | {{STATEMENT_COVERAGE_TARGET}} | {{COVERAGE_TOOL}} |
| ブランチカバレッジ | {{BRANCH_COVERAGE_TARGET}} | {{COVERAGE_TOOL}} |
| バグ密度 | {{BUG_DENSITY_TARGET}} 件/KLOC 以下 | 不具合管理ツール |
| Critical/Major 未解決数 | 0 件 | 不具合管理ツール |
| Minor 未解決数 | {{MINOR_BUG_TARGET}} 件以下 | 不具合管理ツール |
| テスト実行率 | 100% | テスト管理ツール |
| テスト合格率 | {{PASS_RATE_TARGET}} 以上 | テスト管理ツール |

### 定性基準

| 基準 | 判定方法 |
|------|----------|
| 主要ユーザーフロー検証完了 | 全主要シナリオの E2E テスト PASS |
| セキュリティ検証完了 | OWASP Top 10 チェック完了 |
| パフォーマンス検証完了 | 全 NFR-PERF 目標値達成 |
| 受入基準充足 | PO による全 SC の承認 |
| 回帰テスト完了 | 既存機能への影響なし確認 |

---

## 関連ドキュメント

| ドキュメント | リンク |
|-------------|--------|
| 要件一覧 | [user-stories.md](../../docs/requirements/user-stories.md) |
| アーキテクチャ設計書 | [architecture.md](../../docs/03_architecture/architecture.md) |
| データ構造定義 | [data_structure.md](../../docs/04_data_structure/data_structure.md) |
| API設計書 | [api_design.md](../../docs/05_api_design/api_design.md) |
| 画面一覧 | [screen_list.md](../../docs/06_screen_design/screen_list.md) |
| テスト計画書 | [test_plan.md](./test_plan.md) |
| トレーサビリティマトリクス | [traceability_matrix.md](./traceability_matrix.md) |
| 非機能テスト計画書 | [nonfunctional_test_plan.md](./nonfunctional_test_plan.md) |

---

## 変更履歴

| 日付 | バージョン | 変更者 | 変更内容 |
|------|-----------|--------|----------|
| {{DATE}} | 1.0.0 | {{AUTHOR}} | 初版作成 |
